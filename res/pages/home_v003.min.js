"use strict";import{a as H,br as I,div as U,h1 as W,h2 as A,img as D,mountableStylesheet as S,p as T,span as x,text as N}from"../lib/domHelper_v003.min.js";import{fetchApi as F,isMobile as K}from"../lib/lib.js";export default function(t){console.log("Home Init");const e=x(null,"slideOut",x("++")),l=S("./res/pages/home.css"),n=U("introduction",U("block",D("./res/assets/page_home/sort_function.png"),A("排序功能","title"),T("可對搜尋結果的任意欄位進行排序")),U("block",D("./res/assets/page_home/ncku_hub_comment_function.png"),A("NCKU HUB評論","title"),T("點擊課程評分即可查看評論")),U("block",D("./res/assets/page_home/urschool_instructor_info_function.png"),A("UrSchool教授評價","title"),T("點擊教師姓名查看講師評價、詳細資料及評論")),U("block",D("./res/assets/page_home/category_filter_function.png"),A("搜尋結果篩選","title"),T("可以自由選擇篩選條件，提供衝堂、精確節次、班別等篩選器")),U("block",D("./res/assets/page_home/schedule_download_function.png"),A("課表下載","title"),T("提供預排課表檢視，課表下載功能，下載漂亮的課表🥰")),U("block",D("./res/assets/page_home/add_course_function.png"),A("支援預排、選課","title"),T("登入後可跟選課網站連動，進行預排、志願登記、單科加選等操作"),T("搶課一律以成大系統為主，若使用本網站搶課未成功一概不負責","small"))),c=D("https://sticker-assets.dcard.tw/images/4d5acaf6-fb1c-4110-8538-6d2d651b410a/full.png","");let d=0;const m=D("res/assets/icon/icon_64.svg",""),u=U("rippleable",{onclick:e=>{10==++d&&u.replaceChild(c,m);var t,l=e.currentTarget,n=document.createElement("div"),o=Math.sqrt(l.clientWidth*l.clientWidth+l.clientHeight*l.clientHeight),s=(n.style.width=n.style.height=2*o+"px",l.getBoundingClientRect&&l.getBoundingClientRect()),e=(s?(n.style.top=e.pageY-(s.top+o)+"px",n.style.left=e.pageX-(s.left+o)+"px"):n.style.top=n.style.left="0",n.classList.add("ripple"),l.getElementsByClassName("ripple")),i=Date.now&&Date.now()||-1,a=(n.createTime=i,[]);for(const r of e)(-1===i||600<i-r.createTime)&&a.push(r);for(t of a)t.parentElement.removeChild(t);l.appendChild(n)}},m),o=U("siteInfo",W(null,"title",u,x("NCKU"),e),T(null,"description",N("集合"),D("res/assets/NCKU_course_system_logo.png","國立成功大學課程資訊及選課系統"),D("res/assets/nckuHub_logo.svg","NCKUHub"),D("res/assets/UrSchool_logo.png","UrSchool"),I(),N("眾多功能，提供更好的選課環境")),n,H(null,"./?page=CourseSearch","toCourseSearchLink",function(e){e.preventDefault(),t.openPage("CourseSearch"),window.navMenuClose()},x("前往課程查詢"))),s=U("scrollDownIndicator",{onclick:function(){L=!0,K()?this.lastElementChild.scrollIntoView&&this.lastElementChild.scrollIntoView({behavior:"smooth"}):this.scrollIntoView&&this.scrollIntoView({behavior:"smooth"})}},D("./res/assets/down_arrow_icon.svg","","scrollDownArrow"),W("最新消息","title")),a=U("newsPanel",U("splitLine"),U("items")),r=U("bulletinPanel",W("資訊","title"),U("splitLine"),U("items"));let i=!1,h=!1,p=0;const f={enrollmentAnnouncement:"選課公告",enrollmentInformation:"選課資訊",enrollmentFAQs:"選課FAQs",exploringTainan:"踏溯台南路線選擇系統",serviceRecommended:"服務學習推薦專區",contactInformation:"課程資訊服務聯絡窗口"},g=document.createElement("link");g.rel="canonical";let b=!(g.href="https://wavjaby.github.io/NCKUpp/"),_=0,v=(n.onmouseenter=function(){b=!0},n.onmouseleave=function(){b=!1},0),w=0,C=!1,L=!0;function k(){var e=Date.now(),t=e-p;n.scrollLeft!==w?(w=n.scrollLeft,L=!0,p=e,requestAnimationFrame(k)):L?(2e3<t&&(L=!1,p=e),requestAnimationFrame(k)):(p=e,1<(v+=t/1e3*40)&&(C?--n.scrollLeft:n.scrollLeft+=1,w=n.scrollLeft,v%=1),0===n.scrollLeft?C=!1:n.scrollWidth-n.clientWidth-n.scrollLeft<1&&(C=!0,L=!0),i&&requestAnimationFrame(k))}function y(e){b&&(e.preventDefault(),L||(_=n.scrollLeft),L=!0,n.scrollTo?((_+=e.deltaY)<0&&(_=0),n.scrollWidth-n.clientWidth-_<0&&(_=n.scrollWidth-n.clientWidth),n.scrollLeft!==_&&n.scrollTo({left:_,behavior:"smooth"})):n.scrollLeft+=e.deltaY)}function E(){var e=t.element.scrollTop/o.offsetHeight;e<=1&&(o.style.opacity=(1-1.2*e).toString()),h=.5<e?(h||s.classList.add("toLeft"),!0):(h&&s.classList.remove("toLeft"),!1)}return U("home",{onRender:function(){console.log("Home Render"),l.mount(),F("/homeInfo").then(e=>{if(null!=e&&e.success&&e.data){var e=e.data,t=a.lastElementChild;for(const s of e.news){var l=s.contents.map(e=>e instanceof Object?H(e.content,e.url,null,null,{target:"_blank"}):x(e));t.appendChild(U("news",x(s.department,"department"),T(null,"content",l),x(s.date,"date")))}var n=r.lastElementChild,o=e.bulletin;n.appendChild(H("原選課系統","https://course.ncku.edu.tw/","bulletin",null,{target:"_blank"}));for(const i in o)n.appendChild(H(f[i],o[i],"bulletin",null,{target:"_blank"}))}})},onPageClose:function(){console.log("Home Close"),l.disable(),e.style.width=null,document.head.removeChild(g),t.element.removeEventListener("scroll",E),t.element.removeEventListener("wheel",y),i=!1},onPageOpen:function(){console.log("Home Open"),l.enable(),setTimeout(()=>e.style.width=e.firstElementChild.offsetWidth+"px",700),document.head.appendChild(g),t.element.addEventListener("scroll",E),t.element.addEventListener("wheel",y),i=!0,p=Date.now(),k()}},o,s,U("panels",a,r))}